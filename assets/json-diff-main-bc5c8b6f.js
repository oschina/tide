import{c as We}from"./index-60f89a47.js";import{I as Xe}from"./idle-scheduler-7aa0dcbd.js";import"./jsx-runtime-c78ff179.js";import"./index-0dd5bd88.js";import"./TextBubbleMenu-7546d244.js";import"./index-720ea98b.js";import"./preload-helper-b6b5d3b0.js";import"./MentionList-61a78eed.js";import"./utils-fca91e30.js";var De={exports:{}};(function(h){var e=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},n=-1,t=1,a=0;e.Diff=function(r,i){return[r,i]},e.prototype.diff_main=function(r,i,s,o){typeof o>"u"&&(this.Diff_Timeout<=0?o=Number.MAX_VALUE:o=new Date().getTime()+this.Diff_Timeout*1e3);var l=o;if(r==null||i==null)throw new Error("Null input. (diff_main)");if(r==i)return r?[new e.Diff(a,r)]:[];typeof s>"u"&&(s=!0);var f=s,u=this.diff_commonPrefix(r,i),v=r.substring(0,u);r=r.substring(u),i=i.substring(u),u=this.diff_commonSuffix(r,i);var p=r.substring(r.length-u);r=r.substring(0,r.length-u),i=i.substring(0,i.length-u);var d=this.diff_compute_(r,i,f,l);return v&&d.unshift(new e.Diff(a,v)),p&&d.push(new e.Diff(a,p)),this.diff_cleanupMerge(d),d},e.prototype.diff_compute_=function(r,i,s,o){var l;if(!r)return[new e.Diff(t,i)];if(!i)return[new e.Diff(n,r)];var f=r.length>i.length?r:i,u=r.length>i.length?i:r,v=f.indexOf(u);if(v!=-1)return l=[new e.Diff(t,f.substring(0,v)),new e.Diff(a,u),new e.Diff(t,f.substring(v+u.length))],r.length>i.length&&(l[0][0]=l[2][0]=n),l;if(u.length==1)return[new e.Diff(n,r),new e.Diff(t,i)];var p=this.diff_halfMatch_(r,i);if(p){var d=p[0],c=p[1],g=p[2],_=p[3],w=p[4],k=this.diff_main(d,g,s,o),R=this.diff_main(c,_,s,o);return k.concat([new e.Diff(a,w)],R)}return s&&r.length>100&&i.length>100?this.diff_lineMode_(r,i,o):this.diff_bisect_(r,i,o)},e.prototype.diff_lineMode_=function(r,i,s){var o=this.diff_linesToChars_(r,i);r=o.chars1,i=o.chars2;var l=o.lineArray,f=this.diff_main(r,i,!1,s);this.diff_charsToLines_(f,l),this.diff_cleanupSemantic(f),f.push(new e.Diff(a,""));for(var u=0,v=0,p=0,d="",c="";u<f.length;){switch(f[u][0]){case t:p++,c+=f[u][1];break;case n:v++,d+=f[u][1];break;case a:if(v>=1&&p>=1){f.splice(u-v-p,v+p),u=u-v-p;for(var g=this.diff_main(d,c,!1,s),_=g.length-1;_>=0;_--)f.splice(u,0,g[_]);u=u+g.length}p=0,v=0,d="",c="";break}u++}return f.pop(),f},e.prototype.diff_bisect_=function(r,i,s){for(var o=r.length,l=i.length,f=Math.ceil((o+l)/2),u=f,v=2*f,p=new Array(v),d=new Array(v),c=0;c<v;c++)p[c]=-1,d[c]=-1;p[u+1]=0,d[u+1]=0;for(var g=o-l,_=g%2!=0,w=0,k=0,R=0,O=0,j=0;j<f&&!(new Date().getTime()>s);j++){for(var M=-j+w;M<=j-k;M+=2){var A=u+M,P;M==-j||M!=j&&p[A-1]<p[A+1]?P=p[A+1]:P=p[A-1]+1;for(var F=P-M;P<o&&F<l&&r.charAt(P)==i.charAt(F);)P++,F++;if(p[A]=P,P>o)k+=2;else if(F>l)w+=2;else if(_){var S=u+g-M;if(S>=0&&S<v&&d[S]!=-1){var m=o-d[S];if(P>=m)return this.diff_bisectSplit_(r,i,P,F,s)}}}for(var y=-j+R;y<=j-O;y+=2){var S=u+y,m;y==-j||y!=j&&d[S-1]<d[S+1]?m=d[S+1]:m=d[S-1]+1;for(var b=m-y;m<o&&b<l&&r.charAt(o-m-1)==i.charAt(l-b-1);)m++,b++;if(d[S]=m,m>o)O+=2;else if(b>l)R+=2;else if(!_){var A=u+g-y;if(A>=0&&A<v&&p[A]!=-1){var P=p[A],F=u+P-A;if(m=o-m,P>=m)return this.diff_bisectSplit_(r,i,P,F,s)}}}}return[new e.Diff(n,r),new e.Diff(t,i)]},e.prototype.diff_bisectSplit_=function(r,i,s,o,l){var f=r.substring(0,s),u=i.substring(0,o),v=r.substring(s),p=i.substring(o),d=this.diff_main(f,u,!1,l),c=this.diff_main(v,p,!1,l);return d.concat(c)},e.prototype.diff_linesToChars_=function(r,i){var s=[],o={};s[0]="";function l(p){for(var d="",c=0,g=-1,_=s.length;g<p.length-1;){g=p.indexOf(`
`,c),g==-1&&(g=p.length-1);var w=p.substring(c,g+1);(o.hasOwnProperty?o.hasOwnProperty(w):o[w]!==void 0)?d+=String.fromCharCode(o[w]):(_==f&&(w=p.substring(c),g=p.length),d+=String.fromCharCode(_),o[w]=_,s[_++]=w),c=g+1}return d}var f=4e4,u=l(r);f=65535;var v=l(i);return{chars1:u,chars2:v,lineArray:s}},e.prototype.diff_charsToLines_=function(r,i){for(var s=0;s<r.length;s++){for(var o=r[s][1],l=[],f=0;f<o.length;f++)l[f]=i[o.charCodeAt(f)];r[s][1]=l.join("")}},e.prototype.diff_commonPrefix=function(r,i){if(!r||!i||r.charAt(0)!=i.charAt(0))return 0;for(var s=0,o=Math.min(r.length,i.length),l=o,f=0;s<l;)r.substring(f,l)==i.substring(f,l)?(s=l,f=s):o=l,l=Math.floor((o-s)/2+s);return l},e.prototype.diff_commonSuffix=function(r,i){if(!r||!i||r.charAt(r.length-1)!=i.charAt(i.length-1))return 0;for(var s=0,o=Math.min(r.length,i.length),l=o,f=0;s<l;)r.substring(r.length-l,r.length-f)==i.substring(i.length-l,i.length-f)?(s=l,f=s):o=l,l=Math.floor((o-s)/2+s);return l},e.prototype.diff_commonOverlap_=function(r,i){var s=r.length,o=i.length;if(s==0||o==0)return 0;s>o?r=r.substring(s-o):s<o&&(i=i.substring(0,s));var l=Math.min(s,o);if(r==i)return l;for(var f=0,u=1;;){var v=r.substring(l-u),p=i.indexOf(v);if(p==-1)return f;u+=p,(p==0||r.substring(l-u)==i.substring(0,u))&&(f=u,u++)}},e.prototype.diff_halfMatch_=function(r,i){if(this.Diff_Timeout<=0)return null;var s=r.length>i.length?r:i,o=r.length>i.length?i:r;if(s.length<4||o.length*2<s.length)return null;var l=this;function f(k,R,O){for(var j=k.substring(O,O+Math.floor(k.length/4)),M=-1,A="",P,F,S,m;(M=R.indexOf(j,M+1))!=-1;){var y=l.diff_commonPrefix(k.substring(O),R.substring(M)),b=l.diff_commonSuffix(k.substring(0,O),R.substring(0,M));A.length<b+y&&(A=R.substring(M-b,M)+R.substring(M,M+y),P=k.substring(0,O-b),F=k.substring(O+y),S=R.substring(0,M-b),m=R.substring(M+y))}return A.length*2>=k.length?[P,F,S,m,A]:null}var u=f(s,o,Math.ceil(s.length/4)),v=f(s,o,Math.ceil(s.length/2)),p;if(!u&&!v)return null;v?u?p=u[4].length>v[4].length?u:v:p=v:p=u;var d,c,g,_;r.length>i.length?(d=p[0],c=p[1],g=p[2],_=p[3]):(g=p[0],_=p[1],d=p[2],c=p[3]);var w=p[4];return[d,c,g,_,w]},e.prototype.diff_cleanupSemantic=function(r){for(var i=!1,s=[],o=0,l=null,f=0,u=0,v=0,p=0,d=0;f<r.length;)r[f][0]==a?(s[o++]=f,u=p,v=d,p=0,d=0,l=r[f][1]):(r[f][0]==t?p+=r[f][1].length:d+=r[f][1].length,l&&l.length<=Math.max(u,v)&&l.length<=Math.max(p,d)&&(r.splice(s[o-1],0,new e.Diff(n,l)),r[s[o-1]+1][0]=t,o--,o--,f=o>0?s[o-1]:-1,u=0,v=0,p=0,d=0,l=null,i=!0)),f++;for(i&&this.diff_cleanupMerge(r),this.diff_cleanupSemanticLossless(r),f=1;f<r.length;){if(r[f-1][0]==n&&r[f][0]==t){var c=r[f-1][1],g=r[f][1],_=this.diff_commonOverlap_(c,g),w=this.diff_commonOverlap_(g,c);_>=w?(_>=c.length/2||_>=g.length/2)&&(r.splice(f,0,new e.Diff(a,g.substring(0,_))),r[f-1][1]=c.substring(0,c.length-_),r[f+1][1]=g.substring(_),f++):(w>=c.length/2||w>=g.length/2)&&(r.splice(f,0,new e.Diff(a,c.substring(0,w))),r[f-1][0]=t,r[f-1][1]=g.substring(0,g.length-w),r[f+1][0]=n,r[f+1][1]=c.substring(w),f++),f++}f++}},e.prototype.diff_cleanupSemanticLossless=function(r){function i(w,k){if(!w||!k)return 6;var R=w.charAt(w.length-1),O=k.charAt(0),j=R.match(e.nonAlphaNumericRegex_),M=O.match(e.nonAlphaNumericRegex_),A=j&&R.match(e.whitespaceRegex_),P=M&&O.match(e.whitespaceRegex_),F=A&&R.match(e.linebreakRegex_),S=P&&O.match(e.linebreakRegex_),m=F&&w.match(e.blanklineEndRegex_),y=S&&k.match(e.blanklineStartRegex_);return m||y?5:F||S?4:j&&!A&&P?3:A||P?2:j||M?1:0}for(var s=1;s<r.length-1;){if(r[s-1][0]==a&&r[s+1][0]==a){var o=r[s-1][1],l=r[s][1],f=r[s+1][1],u=this.diff_commonSuffix(o,l);if(u){var v=l.substring(l.length-u);o=o.substring(0,o.length-u),l=v+l.substring(0,l.length-u),f=v+f}for(var p=o,d=l,c=f,g=i(o,l)+i(l,f);l.charAt(0)===f.charAt(0);){o+=l.charAt(0),l=l.substring(1)+f.charAt(0),f=f.substring(1);var _=i(o,l)+i(l,f);_>=g&&(g=_,p=o,d=l,c=f)}r[s-1][1]!=p&&(p?r[s-1][1]=p:(r.splice(s-1,1),s--),r[s][1]=d,c?r[s+1][1]=c:(r.splice(s+1,1),s--))}s++}},e.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,e.whitespaceRegex_=/\s/,e.linebreakRegex_=/[\r\n]/,e.blanklineEndRegex_=/\n\r?\n$/,e.blanklineStartRegex_=/^\r?\n\r?\n/,e.prototype.diff_cleanupEfficiency=function(r){for(var i=!1,s=[],o=0,l=null,f=0,u=!1,v=!1,p=!1,d=!1;f<r.length;)r[f][0]==a?(r[f][1].length<this.Diff_EditCost&&(p||d)?(s[o++]=f,u=p,v=d,l=r[f][1]):(o=0,l=null),p=d=!1):(r[f][0]==n?d=!0:p=!0,l&&(u&&v&&p&&d||l.length<this.Diff_EditCost/2&&u+v+p+d==3)&&(r.splice(s[o-1],0,new e.Diff(n,l)),r[s[o-1]+1][0]=t,o--,l=null,u&&v?(p=d=!0,o=0):(o--,f=o>0?s[o-1]:-1,p=d=!1),i=!0)),f++;i&&this.diff_cleanupMerge(r)},e.prototype.diff_cleanupMerge=function(r){r.push(new e.Diff(a,""));for(var i=0,s=0,o=0,l="",f="",u;i<r.length;)switch(r[i][0]){case t:o++,f+=r[i][1],i++;break;case n:s++,l+=r[i][1],i++;break;case a:s+o>1?(s!==0&&o!==0&&(u=this.diff_commonPrefix(f,l),u!==0&&(i-s-o>0&&r[i-s-o-1][0]==a?r[i-s-o-1][1]+=f.substring(0,u):(r.splice(0,0,new e.Diff(a,f.substring(0,u))),i++),f=f.substring(u),l=l.substring(u)),u=this.diff_commonSuffix(f,l),u!==0&&(r[i][1]=f.substring(f.length-u)+r[i][1],f=f.substring(0,f.length-u),l=l.substring(0,l.length-u))),i-=s+o,r.splice(i,s+o),l.length&&(r.splice(i,0,new e.Diff(n,l)),i++),f.length&&(r.splice(i,0,new e.Diff(t,f)),i++),i++):i!==0&&r[i-1][0]==a?(r[i-1][1]+=r[i][1],r.splice(i,1)):i++,o=0,s=0,l="",f="";break}r[r.length-1][1]===""&&r.pop();var v=!1;for(i=1;i<r.length-1;)r[i-1][0]==a&&r[i+1][0]==a&&(r[i][1].substring(r[i][1].length-r[i-1][1].length)==r[i-1][1]?(r[i][1]=r[i-1][1]+r[i][1].substring(0,r[i][1].length-r[i-1][1].length),r[i+1][1]=r[i-1][1]+r[i+1][1],r.splice(i-1,1),v=!0):r[i][1].substring(0,r[i+1][1].length)==r[i+1][1]&&(r[i-1][1]+=r[i+1][1],r[i][1]=r[i][1].substring(r[i+1][1].length)+r[i+1][1],r.splice(i+1,1),v=!0)),i++;v&&this.diff_cleanupMerge(r)},e.prototype.diff_xIndex=function(r,i){var s=0,o=0,l=0,f=0,u;for(u=0;u<r.length&&(r[u][0]!==t&&(s+=r[u][1].length),r[u][0]!==n&&(o+=r[u][1].length),!(s>i));u++)l=s,f=o;return r.length!=u&&r[u][0]===n?f:f+(i-l)},e.prototype.diff_prettyHtml=function(r){for(var i=[],s=/&/g,o=/</g,l=/>/g,f=/\n/g,u=0;u<r.length;u++){var v=r[u][0],p=r[u][1],d=p.replace(s,"&amp;").replace(o,"&lt;").replace(l,"&gt;").replace(f,"&para;<br>");switch(v){case t:i[u]='<ins style="background:#e6ffe6;">'+d+"</ins>";break;case n:i[u]='<del style="background:#ffe6e6;">'+d+"</del>";break;case a:i[u]="<span>"+d+"</span>";break}}return i.join("")},e.prototype.diff_text1=function(r){for(var i=[],s=0;s<r.length;s++)r[s][0]!==t&&(i[s]=r[s][1]);return i.join("")},e.prototype.diff_text2=function(r){for(var i=[],s=0;s<r.length;s++)r[s][0]!==n&&(i[s]=r[s][1]);return i.join("")},e.prototype.diff_levenshtein=function(r){for(var i=0,s=0,o=0,l=0;l<r.length;l++){var f=r[l][0],u=r[l][1];switch(f){case t:s+=u.length;break;case n:o+=u.length;break;case a:i+=Math.max(s,o),s=0,o=0;break}}return i+=Math.max(s,o),i},e.prototype.diff_toDelta=function(r){for(var i=[],s=0;s<r.length;s++)switch(r[s][0]){case t:i[s]="+"+encodeURI(r[s][1]);break;case n:i[s]="-"+r[s][1].length;break;case a:i[s]="="+r[s][1].length;break}return i.join("	").replace(/%20/g," ")},e.prototype.diff_fromDelta=function(r,i){for(var s=[],o=0,l=0,f=i.split(/\t/g),u=0;u<f.length;u++){var v=f[u].substring(1);switch(f[u].charAt(0)){case"+":try{s[o++]=new e.Diff(t,decodeURI(v))}catch{throw new Error("Illegal escape in diff_fromDelta: "+v)}break;case"-":case"=":var p=parseInt(v,10);if(isNaN(p)||p<0)throw new Error("Invalid number in diff_fromDelta: "+v);var d=r.substring(l,l+=p);f[u].charAt(0)=="="?s[o++]=new e.Diff(a,d):s[o++]=new e.Diff(n,d);break;default:if(f[u])throw new Error("Invalid diff operation in diff_fromDelta: "+f[u])}}if(l!=r.length)throw new Error("Delta length ("+l+") does not equal source text length ("+r.length+").");return s},e.prototype.match_main=function(r,i,s){if(r==null||i==null||s==null)throw new Error("Null input. (match_main)");return s=Math.max(0,Math.min(s,r.length)),r==i?0:r.length?r.substring(s,s+i.length)==i?s:this.match_bitap_(r,i,s):-1},e.prototype.match_bitap_=function(r,i,s){if(i.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var o=this.match_alphabet_(i),l=this;function f(P,F){var S=P/i.length,m=Math.abs(s-F);return l.Match_Distance?S+m/l.Match_Distance:m?1:S}var u=this.Match_Threshold,v=r.indexOf(i,s);v!=-1&&(u=Math.min(f(0,v),u),v=r.lastIndexOf(i,s+i.length),v!=-1&&(u=Math.min(f(0,v),u)));var p=1<<i.length-1;v=-1;for(var d,c,g=i.length+r.length,_,w=0;w<i.length;w++){for(d=0,c=g;d<c;)f(w,s+c)<=u?d=c:g=c,c=Math.floor((g-d)/2+d);g=c;var k=Math.max(1,s-c+1),R=Math.min(s+c,r.length)+i.length,O=Array(R+2);O[R+1]=(1<<w)-1;for(var j=R;j>=k;j--){var M=o[r.charAt(j-1)];if(w===0?O[j]=(O[j+1]<<1|1)&M:O[j]=(O[j+1]<<1|1)&M|((_[j+1]|_[j])<<1|1)|_[j+1],O[j]&p){var A=f(w,j-1);if(A<=u)if(u=A,v=j-1,v>s)k=Math.max(1,2*s-v);else break}}if(f(w+1,s)>u)break;_=O}return v},e.prototype.match_alphabet_=function(r){for(var i={},s=0;s<r.length;s++)i[r.charAt(s)]=0;for(var s=0;s<r.length;s++)i[r.charAt(s)]|=1<<r.length-s-1;return i},e.prototype.patch_addContext_=function(r,i){if(i.length!=0){if(r.start2===null)throw Error("patch not initialized");for(var s=i.substring(r.start2,r.start2+r.length1),o=0;i.indexOf(s)!=i.lastIndexOf(s)&&s.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)o+=this.Patch_Margin,s=i.substring(r.start2-o,r.start2+r.length1+o);o+=this.Patch_Margin;var l=i.substring(r.start2-o,r.start2);l&&r.diffs.unshift(new e.Diff(a,l));var f=i.substring(r.start2+r.length1,r.start2+r.length1+o);f&&r.diffs.push(new e.Diff(a,f)),r.start1-=l.length,r.start2-=l.length,r.length1+=l.length+f.length,r.length2+=l.length+f.length}},e.prototype.patch_make=function(r,i,s){var o,l;if(typeof r=="string"&&typeof i=="string"&&typeof s>"u")o=r,l=this.diff_main(o,i,!0),l.length>2&&(this.diff_cleanupSemantic(l),this.diff_cleanupEfficiency(l));else if(r&&typeof r=="object"&&typeof i>"u"&&typeof s>"u")l=r,o=this.diff_text1(l);else if(typeof r=="string"&&i&&typeof i=="object"&&typeof s>"u")o=r,l=i;else if(typeof r=="string"&&typeof i=="string"&&s&&typeof s=="object")o=r,l=s;else throw new Error("Unknown call format to patch_make.");if(l.length===0)return[];for(var f=[],u=new e.patch_obj,v=0,p=0,d=0,c=o,g=o,_=0;_<l.length;_++){var w=l[_][0],k=l[_][1];switch(!v&&w!==a&&(u.start1=p,u.start2=d),w){case t:u.diffs[v++]=l[_],u.length2+=k.length,g=g.substring(0,d)+k+g.substring(d);break;case n:u.length1+=k.length,u.diffs[v++]=l[_],g=g.substring(0,d)+g.substring(d+k.length);break;case a:k.length<=2*this.Patch_Margin&&v&&l.length!=_+1?(u.diffs[v++]=l[_],u.length1+=k.length,u.length2+=k.length):k.length>=2*this.Patch_Margin&&v&&(this.patch_addContext_(u,c),f.push(u),u=new e.patch_obj,v=0,c=g,p=d);break}w!==t&&(p+=k.length),w!==n&&(d+=k.length)}return v&&(this.patch_addContext_(u,c),f.push(u)),f},e.prototype.patch_deepCopy=function(r){for(var i=[],s=0;s<r.length;s++){var o=r[s],l=new e.patch_obj;l.diffs=[];for(var f=0;f<o.diffs.length;f++)l.diffs[f]=new e.Diff(o.diffs[f][0],o.diffs[f][1]);l.start1=o.start1,l.start2=o.start2,l.length1=o.length1,l.length2=o.length2,i[s]=l}return i},e.prototype.patch_apply=function(r,i){if(r.length==0)return[i,[]];r=this.patch_deepCopy(r);var s=this.patch_addPadding(r);i=s+i+s,this.patch_splitMax(r);for(var o=0,l=[],f=0;f<r.length;f++){var u=r[f].start2+o,v=this.diff_text1(r[f].diffs),p,d=-1;if(v.length>this.Match_MaxBits?(p=this.match_main(i,v.substring(0,this.Match_MaxBits),u),p!=-1&&(d=this.match_main(i,v.substring(v.length-this.Match_MaxBits),u+v.length-this.Match_MaxBits),(d==-1||p>=d)&&(p=-1))):p=this.match_main(i,v,u),p==-1)l[f]=!1,o-=r[f].length2-r[f].length1;else{l[f]=!0,o=p-u;var c;if(d==-1?c=i.substring(p,p+v.length):c=i.substring(p,d+this.Match_MaxBits),v==c)i=i.substring(0,p)+this.diff_text2(r[f].diffs)+i.substring(p+v.length);else{var g=this.diff_main(v,c,!1);if(v.length>this.Match_MaxBits&&this.diff_levenshtein(g)/v.length>this.Patch_DeleteThreshold)l[f]=!1;else{this.diff_cleanupSemanticLossless(g);for(var _=0,w,k=0;k<r[f].diffs.length;k++){var R=r[f].diffs[k];R[0]!==a&&(w=this.diff_xIndex(g,_)),R[0]===t?i=i.substring(0,p+w)+R[1]+i.substring(p+w):R[0]===n&&(i=i.substring(0,p+w)+i.substring(p+this.diff_xIndex(g,_+R[1].length))),R[0]!==n&&(_+=R[1].length)}}}}}return i=i.substring(s.length,i.length-s.length),[i,l]},e.prototype.patch_addPadding=function(r){for(var i=this.Patch_Margin,s="",o=1;o<=i;o++)s+=String.fromCharCode(o);for(var o=0;o<r.length;o++)r[o].start1+=i,r[o].start2+=i;var l=r[0],f=l.diffs;if(f.length==0||f[0][0]!=a)f.unshift(new e.Diff(a,s)),l.start1-=i,l.start2-=i,l.length1+=i,l.length2+=i;else if(i>f[0][1].length){var u=i-f[0][1].length;f[0][1]=s.substring(f[0][1].length)+f[0][1],l.start1-=u,l.start2-=u,l.length1+=u,l.length2+=u}if(l=r[r.length-1],f=l.diffs,f.length==0||f[f.length-1][0]!=a)f.push(new e.Diff(a,s)),l.length1+=i,l.length2+=i;else if(i>f[f.length-1][1].length){var u=i-f[f.length-1][1].length;f[f.length-1][1]+=s.substring(0,u),l.length1+=u,l.length2+=u}return s},e.prototype.patch_splitMax=function(r){for(var i=this.Match_MaxBits,s=0;s<r.length;s++)if(!(r[s].length1<=i)){var o=r[s];r.splice(s--,1);for(var l=o.start1,f=o.start2,u="";o.diffs.length!==0;){var v=new e.patch_obj,p=!0;for(v.start1=l-u.length,v.start2=f-u.length,u!==""&&(v.length1=v.length2=u.length,v.diffs.push(new e.Diff(a,u)));o.diffs.length!==0&&v.length1<i-this.Patch_Margin;){var d=o.diffs[0][0],c=o.diffs[0][1];d===t?(v.length2+=c.length,f+=c.length,v.diffs.push(o.diffs.shift()),p=!1):d===n&&v.diffs.length==1&&v.diffs[0][0]==a&&c.length>2*i?(v.length1+=c.length,l+=c.length,p=!1,v.diffs.push(new e.Diff(d,c)),o.diffs.shift()):(c=c.substring(0,i-v.length1-this.Patch_Margin),v.length1+=c.length,l+=c.length,d===a?(v.length2+=c.length,f+=c.length):p=!1,v.diffs.push(new e.Diff(d,c)),c==o.diffs[0][1]?o.diffs.shift():o.diffs[0][1]=o.diffs[0][1].substring(c.length))}u=this.diff_text2(v.diffs),u=u.substring(u.length-this.Patch_Margin);var g=this.diff_text1(o.diffs).substring(0,this.Patch_Margin);g!==""&&(v.length1+=g.length,v.length2+=g.length,v.diffs.length!==0&&v.diffs[v.diffs.length-1][0]===a?v.diffs[v.diffs.length-1][1]+=g:v.diffs.push(new e.Diff(a,g))),p||r.splice(++s,0,v)}}},e.prototype.patch_toText=function(r){for(var i=[],s=0;s<r.length;s++)i[s]=r[s];return i.join("")},e.prototype.patch_fromText=function(r){var i=[];if(!r)return i;for(var s=r.split(`
`),o=0,l=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;o<s.length;){var f=s[o].match(l);if(!f)throw new Error("Invalid patch string: "+s[o]);var u=new e.patch_obj;for(i.push(u),u.start1=parseInt(f[1],10),f[2]===""?(u.start1--,u.length1=1):f[2]=="0"?u.length1=0:(u.start1--,u.length1=parseInt(f[2],10)),u.start2=parseInt(f[3],10),f[4]===""?(u.start2--,u.length2=1):f[4]=="0"?u.length2=0:(u.start2--,u.length2=parseInt(f[4],10)),o++;o<s.length;){var v=s[o].charAt(0);try{var p=decodeURI(s[o].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+p)}if(v=="-")u.diffs.push(new e.Diff(n,p));else if(v=="+")u.diffs.push(new e.Diff(t,p));else if(v==" ")u.diffs.push(new e.Diff(a,p));else{if(v=="@")break;if(v!=="")throw new Error('Invalid patch mode "'+v+'" in: '+p)}o++}}return i},e.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},e.patch_obj.prototype.toString=function(){var r,i;this.length1===0?r=this.start1+",0":this.length1==1?r=this.start1+1:r=this.start1+1+","+this.length1,this.length2===0?i=this.start2+",0":this.length2==1?i=this.start2+1:i=this.start2+1+","+this.length2;for(var s=["@@ -"+r+" +"+i+` @@
`],o,l=0;l<this.diffs.length;l++){switch(this.diffs[l][0]){case t:o="+";break;case n:o="-";break;case a:o=" ";break}s[l+1]=o+encodeURI(this.diffs[l][1])+`
`}return s.join("").replace(/%20/g," ")},h.exports=e,h.exports.diff_match_patch=e,h.exports.DIFF_DELETE=n,h.exports.DIFF_INSERT=t,h.exports.DIFF_EQUAL=a})(De);const se=De.exports;var Re={exports:{}},qe=/[|\\{}()[\]^$+*?.]/g,Ze=function(h){if(typeof h!="string")throw new TypeError("Expected a string");return h.replace(qe,"\\$&")},je={exports:{}};(function(h){const e=We,n=(i,s)=>function(){return`\x1B[${i.apply(e,arguments)+s}m`},t=(i,s)=>function(){const o=i.apply(e,arguments);return`\x1B[${38+s};5;${o}m`},a=(i,s)=>function(){const o=i.apply(e,arguments);return`\x1B[${38+s};2;${o[0]};${o[1]};${o[2]}m`};function r(){const i=new Map,s={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};s.color.grey=s.color.gray;for(const f of Object.keys(s)){const u=s[f];for(const v of Object.keys(u)){const p=u[v];s[v]={open:`\x1B[${p[0]}m`,close:`\x1B[${p[1]}m`},u[v]=s[v],i.set(p[0],p[1])}Object.defineProperty(s,f,{value:u,enumerable:!1}),Object.defineProperty(s,"codes",{value:i,enumerable:!1})}const o=f=>f,l=(f,u,v)=>[f,u,v];s.color.close="\x1B[39m",s.bgColor.close="\x1B[49m",s.color.ansi={ansi:n(o,0)},s.color.ansi256={ansi256:t(o,0)},s.color.ansi16m={rgb:a(l,0)},s.bgColor.ansi={ansi:n(o,10)},s.bgColor.ansi256={ansi256:t(o,10)},s.bgColor.ansi16m={rgb:a(l,10)};for(let f of Object.keys(e)){if(typeof e[f]!="object")continue;const u=e[f];f==="ansi16"&&(f="ansi"),"ansi16"in u&&(s.color.ansi[f]=n(u.ansi16,0),s.bgColor.ansi[f]=n(u.ansi16,10)),"ansi256"in u&&(s.color.ansi256[f]=t(u.ansi256,0),s.bgColor.ansi256[f]=t(u.ansi256,10)),"rgb"in u&&(s.color.ansi16m[f]=a(u.rgb,0),s.bgColor.ansi16m[f]=a(u.rgb,10))}return s}Object.defineProperty(h,"exports",{enumerable:!0,get:r})})(je);var Ke={stdout:!1,stderr:!1};const xe=/(?:\\(u[a-f\d]{4}|x[a-f\d]{2}|.))|(?:\{(~)?(\w+(?:\([^)]*\))?(?:\.\w+(?:\([^)]*\))?)*)(?:[ \t]|(?=\r?\n)))|(\})|((?:.|[\r\n\f])+?)/gi,ce=/(?:^|\.)(\w+)(?:\(([^)]*)\))?/g,er=/^(['"])((?:\\.|(?!\1)[^\\])*)\1$/,rr=/\\(u[a-f\d]{4}|x[a-f\d]{2}|.)|([^\\])/gi,tr=new Map([["n",`
`],["r","\r"],["t","	"],["b","\b"],["f","\f"],["v","\v"],["0","\0"],["\\","\\"],["e","\x1B"],["a","\x07"]]);function Me(h){return h[0]==="u"&&h.length===5||h[0]==="x"&&h.length===3?String.fromCharCode(parseInt(h.slice(1),16)):tr.get(h)||h}function nr(h,e){const n=[],t=e.trim().split(/\s*,\s*/g);let a;for(const r of t)if(!isNaN(r))n.push(Number(r));else if(a=r.match(er))n.push(a[2].replace(rr,(i,s,o)=>s?Me(s):o));else throw new Error(`Invalid Chalk template style argument: ${r} (in style '${h}')`);return n}function ir(h){ce.lastIndex=0;const e=[];let n;for(;(n=ce.exec(h))!==null;){const t=n[1];if(n[2]){const a=nr(t,n[2]);e.push([t].concat(a))}else e.push([t])}return e}function de(h,e){const n={};for(const a of e)for(const r of a.styles)n[r[0]]=a.inverse?null:r.slice(1);let t=h;for(const a of Object.keys(n))if(Array.isArray(n[a])){if(!(a in t))throw new Error(`Unknown Chalk style: ${a}`);n[a].length>0?t=t[a].apply(t,n[a]):t=t[a]}return t}var ar=(h,e)=>{const n=[],t=[];let a=[];if(e.replace(xe,(r,i,s,o,l,f)=>{if(i)a.push(Me(i));else if(o){const u=a.join("");a=[],t.push(n.length===0?u:de(h,n)(u)),n.push({inverse:s,styles:ir(o)})}else if(l){if(n.length===0)throw new Error("Found extraneous } in Chalk template literal");t.push(de(h,n)(a.join(""))),a=[],n.pop()}else a.push(f)}),t.push(a.join("")),n.length>0){const r=`Chalk template literal is missing ${n.length} closing bracket${n.length===1?"":"s"} (\`}\`)`;throw new Error(r)}return t.join("")};(function(h){const e=Ze,n=je.exports,t=Ke.stdout,a=ar,r=process.platform==="win32"&&!({}.TERM||"").toLowerCase().startsWith("xterm"),i=["ansi","ansi","ansi256","ansi16m"],s=new Set(["gray"]),o=Object.create(null);function l(c,g){g=g||{};const _=0;c.level=g.level===void 0?_:g.level,c.enabled="enabled"in g?g.enabled:c.level>0}function f(c){if(!this||!(this instanceof f)||this.template){const g={};return l(g,c),g.template=function(){const _=[].slice.call(arguments);return d.apply(null,[g.template].concat(_))},Object.setPrototypeOf(g,f.prototype),Object.setPrototypeOf(g.template,g),g.template.constructor=f,g.template}l(this,c)}r&&(n.blue.open="\x1B[94m");for(const c of Object.keys(n))n[c].closeRe=new RegExp(e(n[c].close),"g"),o[c]={get(){const g=n[c];return v.call(this,this._styles?this._styles.concat(g):[g],this._empty,c)}};o.visible={get(){return v.call(this,this._styles||[],!0,"visible")}},n.color.closeRe=new RegExp(e(n.color.close),"g");for(const c of Object.keys(n.color.ansi))s.has(c)||(o[c]={get(){const g=this.level;return function(){const w={open:n.color[i[g]][c].apply(null,arguments),close:n.color.close,closeRe:n.color.closeRe};return v.call(this,this._styles?this._styles.concat(w):[w],this._empty,c)}}});n.bgColor.closeRe=new RegExp(e(n.bgColor.close),"g");for(const c of Object.keys(n.bgColor.ansi)){if(s.has(c))continue;const g="bg"+c[0].toUpperCase()+c.slice(1);o[g]={get(){const _=this.level;return function(){const k={open:n.bgColor[i[_]][c].apply(null,arguments),close:n.bgColor.close,closeRe:n.bgColor.closeRe};return v.call(this,this._styles?this._styles.concat(k):[k],this._empty,c)}}}}const u=Object.defineProperties(()=>{},o);function v(c,g,_){const w=function(){return p.apply(w,arguments)};w._styles=c,w._empty=g;const k=this;return Object.defineProperty(w,"level",{enumerable:!0,get(){return k.level},set(R){k.level=R}}),Object.defineProperty(w,"enabled",{enumerable:!0,get(){return k.enabled},set(R){k.enabled=R}}),w.hasGrey=this.hasGrey||_==="gray"||_==="grey",w.__proto__=u,w}function p(){const c=arguments,g=c.length;let _=String(arguments[0]);if(g===0)return"";if(g>1)for(let k=1;k<g;k++)_+=" "+c[k];if(!this.enabled||this.level<=0||!_)return this._empty?"":_;const w=n.dim.open;r&&this.hasGrey&&(n.dim.open="");for(const k of this._styles.slice().reverse())_=k.open+_.replace(k.closeRe,k.open)+k.close,_=_.replace(/\r?\n/g,`${k.close}$&${k.open}`);return n.dim.open=w,_}function d(c,g){if(!Array.isArray(g))return[].slice.call(arguments,1).join(" ");const _=[].slice.call(arguments,2),w=[g.raw[0]];for(let k=1;k<g.length;k++)w.push(String(_[k-1]).replace(/[{}\\]/g,"\\$&")),w.push(String(g.raw[k]));return a(c,w.join(""))}Object.defineProperties(f.prototype,o),h.exports=f(),h.exports.supportsColor=t,h.exports.default=h.exports})(Re);const ge=Re.exports;var I=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},L=function(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")},$=function(){function h(e,n){for(var t=0;t<n.length;t++){var a=n[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,n,t){return n&&h(e.prototype,n),t&&h(e,t),e}}(),he=function h(e,n,t){e===null&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,n);if(a===void 0){var r=Object.getPrototypeOf(e);return r===null?void 0:h(r,n,t)}else{if("value"in a)return a.value;var i=a.get;return i===void 0?void 0:i.call(t)}},z=function(h,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);h.prototype=Object.create(e&&e.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(h,e):h.__proto__=e)},J=function(h,e){if(!h)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:h},sr=function(){function h(e){L(this,h),this.selfOptions=e||{},this.pipes={}}return $(h,[{key:"options",value:function(n){return n&&(this.selfOptions=n),this.selfOptions}},{key:"pipe",value:function(n,t){var a=t;if(typeof n=="string"){if(typeof a>"u")return this.pipes[n];this.pipes[n]=a}if(n&&n.name){if(a=n,a.processor===this)return a;this.pipes[a.name]=a}return a.processor=this,a}},{key:"process",value:function(n,t){var a=n;a.options=this.options();for(var r=t||n.pipe||"default",i=void 0,s=void 0;r;)typeof a.nextAfterChildren<"u"&&(a.next=a.nextAfterChildren,a.nextAfterChildren=null),typeof r=="string"&&(r=this.pipe(r)),r.process(a),s=a,i=r,r=null,a&&a.next&&(a=a.next,r=s.nextPipe||a.pipe||i);return a.hasResult?a.result:void 0}}]),h}(),ee=function(){function h(e){L(this,h),this.name=e,this.filters=[]}return $(h,[{key:"process",value:function(n){if(!this.processor)throw new Error("add this pipe to a processor before using it");for(var t=this.debug,a=this.filters.length,r=n,i=0;i<a;i++){var s=this.filters[i];if(t&&this.log("filter: "+s.filterName),s(r),(typeof r>"u"?"undefined":I(r))==="object"&&r.exiting){r.exiting=!1;break}}!r.next&&this.resultCheck&&this.resultCheck(r)}},{key:"log",value:function(n){console.log("[jsondiffpatch] "+this.name+" pipe, "+n)}},{key:"append",value:function(){var n;return(n=this.filters).push.apply(n,arguments),this}},{key:"prepend",value:function(){var n;return(n=this.filters).unshift.apply(n,arguments),this}},{key:"indexOf",value:function(n){if(!n)throw new Error("a filter name is required");for(var t=0;t<this.filters.length;t++){var a=this.filters[t];if(a.filterName===n)return t}throw new Error("filter not found: "+n)}},{key:"list",value:function(){return this.filters.map(function(n){return n.filterName})}},{key:"after",value:function(n){var t=this.indexOf(n),a=Array.prototype.slice.call(arguments,1);if(!a.length)throw new Error("a filter is required");return a.unshift(t+1,0),Array.prototype.splice.apply(this.filters,a),this}},{key:"before",value:function(n){var t=this.indexOf(n),a=Array.prototype.slice.call(arguments,1);if(!a.length)throw new Error("a filter is required");return a.unshift(t,0),Array.prototype.splice.apply(this.filters,a),this}},{key:"replace",value:function(n){var t=this.indexOf(n),a=Array.prototype.slice.call(arguments,1);if(!a.length)throw new Error("a filter is required");return a.unshift(t,1),Array.prototype.splice.apply(this.filters,a),this}},{key:"remove",value:function(n){var t=this.indexOf(n);return this.filters.splice(t,1),this}},{key:"clear",value:function(){return this.filters.length=0,this}},{key:"shouldHaveResult",value:function(n){if(n===!1){this.resultCheck=null;return}if(!this.resultCheck){var t=this;return this.resultCheck=function(a){if(!a.hasResult){console.log(a);var r=new Error(t.name+" failed");throw r.noResult=!0,r}},this}}}]),h}(),re=function(){function h(){L(this,h)}return $(h,[{key:"setResult",value:function(n){return this.result=n,this.hasResult=!0,this}},{key:"exit",value:function(){return this.exiting=!0,this}},{key:"switchTo",value:function(n,t){return typeof n=="string"||n instanceof ee?this.nextPipe=n:(this.next=n,t&&(this.nextPipe=t)),this}},{key:"push",value:function(n,t){return n.parent=this,typeof t<"u"&&(n.childName=t),n.root=this.root||this,n.options=n.options||this.options,this.children?(this.children[this.children.length-1].next=n,this.children.push(n)):(this.children=[n],this.nextAfterChildren=this.next||null,this.next=n),n.next=this,this}}]),h}(),or=typeof Array.isArray=="function"?Array.isArray:function(h){return h instanceof Array};function fr(h){var e=/^\/(.*)\/([gimyu]*)$/.exec(h.toString());return new RegExp(e[1],e[2])}function te(h){if((typeof h>"u"?"undefined":I(h))!=="object")return h;if(h===null)return null;if(or(h))return h.map(te);if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp)return fr(h);var e={};for(var n in h)Object.prototype.hasOwnProperty.call(h,n)&&(e[n]=te(h[n]));return e}var Y=function(h){z(e,h);function e(n,t){L(this,e);var a=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.left=n,a.right=t,a.pipe="diff",a}return $(e,[{key:"setResult",value:function(t){if(this.options.cloneDiffValues&&(typeof t>"u"?"undefined":I(t))==="object"){var a=typeof this.options.cloneDiffValues=="function"?this.options.cloneDiffValues:te;I(t[0])==="object"&&(t[0]=a(t[0])),I(t[1])==="object"&&(t[1]=a(t[1]))}return re.prototype.setResult.apply(this,arguments)}}]),e}(re),ve=function(h){z(e,h);function e(n,t){L(this,e);var a=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return a.left=n,a.delta=t,a.pipe="patch",a}return e}(re),pe=function(h){z(e,h);function e(n){L(this,e);var t=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.delta=n,t.pipe="reverse",t}return e}(re),ne=typeof Array.isArray=="function"?Array.isArray:function(h){return h instanceof Array},Oe=function(e){if(e.left===e.right){e.setResult(void 0).exit();return}if(typeof e.left>"u"){if(typeof e.right=="function")throw new Error("functions are not supported");e.setResult([e.right]).exit();return}if(typeof e.right>"u"){e.setResult([e.left,0,0]).exit();return}if(typeof e.left=="function"||typeof e.right=="function")throw new Error("functions are not supported");if(e.leftType=e.left===null?"null":I(e.left),e.rightType=e.right===null?"null":I(e.right),e.leftType!==e.rightType){e.setResult([e.left,e.right]).exit();return}if(e.leftType==="boolean"||e.leftType==="number"){e.setResult([e.left,e.right]).exit();return}if(e.leftType==="object"&&(e.leftIsArray=ne(e.left)),e.rightType==="object"&&(e.rightIsArray=ne(e.right)),e.leftIsArray!==e.rightIsArray){e.setResult([e.left,e.right]).exit();return}e.left instanceof RegExp&&(e.right instanceof RegExp?e.setResult([e.left.toString(),e.right.toString()]).exit():e.setResult([e.left,e.right]).exit())};Oe.filterName="trivial";var Ae=function(e){if(typeof e.delta>"u"){e.setResult(e.left).exit();return}if(e.nested=!ne(e.delta),!e.nested){if(e.delta.length===1){e.setResult(e.delta[0]).exit();return}if(e.delta.length===2){if(e.left instanceof RegExp){var n=/^\/(.*)\/([gimyu]+)$/.exec(e.delta[1]);if(n){e.setResult(new RegExp(n[1],n[2])).exit();return}}e.setResult(e.delta[1]).exit();return}e.delta.length===3&&e.delta[2]===0&&e.setResult(void 0).exit()}};Ae.filterName="trivial";var Pe=function(e){if(typeof e.delta>"u"){e.setResult(e.delta).exit();return}if(e.nested=!ne(e.delta),!e.nested){if(e.delta.length===1){e.setResult([e.delta[0],0,0]).exit();return}if(e.delta.length===2){e.setResult([e.delta[1],e.delta[0]]).exit();return}e.delta.length===3&&e.delta[2]===0&&e.setResult([e.delta[0]]).exit()}};Pe.filterName="trivial";function Se(h){if(!(!h||!h.children)){for(var e=h.children.length,n=void 0,t=h.result,a=0;a<e;a++)n=h.children[a],!(typeof n.result>"u")&&(t=t||{},t[n.childName]=n.result);t&&h.leftIsArray&&(t._t="a"),h.setResult(t).exit()}}Se.filterName="collectChildren";function Te(h){if(!(h.leftIsArray||h.leftType!=="object")){var e=void 0,n=void 0,t=h.options.propertyFilter;for(e in h.left)!Object.prototype.hasOwnProperty.call(h.left,e)||t&&!t(e,h)||(n=new Y(h.left[e],h.right[e]),h.push(n,e));for(e in h.right)!Object.prototype.hasOwnProperty.call(h.right,e)||t&&!t(e,h)||typeof h.left[e]>"u"&&(n=new Y(void 0,h.right[e]),h.push(n,e));if(!h.children||h.children.length===0){h.setResult(void 0).exit();return}h.exit()}}Te.filterName="objects";var Fe=function(e){if(!!e.nested&&!e.delta._t){var n=void 0,t=void 0;for(n in e.delta)t=new ve(e.left[n],e.delta[n]),e.push(t,n);e.exit()}};Fe.filterName="objects";var Ne=function(e){if(!(!e||!e.children)&&!e.delta._t){for(var n=e.children.length,t=void 0,a=0;a<n;a++)t=e.children[a],Object.prototype.hasOwnProperty.call(e.left,t.childName)&&t.result===void 0?delete e.left[t.childName]:e.left[t.childName]!==t.result&&(e.left[t.childName]=t.result);e.setResult(e.left).exit()}};Ne.filterName="collectChildren";var Be=function(e){if(!!e.nested&&!e.delta._t){var n=void 0,t=void 0;for(n in e.delta)t=new pe(e.delta[n]),e.push(t,n);e.exit()}};Be.filterName="objects";function Le(h){if(!(!h||!h.children)&&!h.delta._t){for(var e=h.children.length,n=void 0,t={},a=0;a<e;a++)n=h.children[a],t[n.childName]!==n.result&&(t[n.childName]=n.result);h.setResult(t).exit()}}Le.filterName="collectChildren";var lr=function(e,n,t,a){return e[t]===n[a]},ur=function(e,n,t,a){var r=e.length,i=n.length,s=void 0,o=void 0,l=[r+1];for(s=0;s<r+1;s++)for(l[s]=[i+1],o=0;o<i+1;o++)l[s][o]=0;for(l.match=t,s=1;s<r+1;s++)for(o=1;o<i+1;o++)t(e,n,s-1,o-1,a)?l[s][o]=l[s-1][o-1]+1:l[s][o]=Math.max(l[s-1][o],l[s][o-1]);return l},hr=function(e,n,t,a){for(var r=n.length,i=t.length,s={sequence:[],indices1:[],indices2:[]};r!==0&&i!==0;){var o=e.match(n,t,r-1,i-1,a);if(o)s.sequence.unshift(n[r-1]),s.indices1.unshift(r-1),s.indices2.unshift(i-1),--r,--i;else{var l=e[r][i-1],f=e[r-1][i];l>f?--i:--r}}return s},vr=function(e,n,t,a){var r=a||{},i=ur(e,n,t||lr,r),s=hr(i,e,n,r);return typeof e=="string"&&typeof n=="string"&&(s.sequence=s.sequence.join("")),s},pr={get:vr},W=3,ye=typeof Array.isArray=="function"?Array.isArray:function(h){return h instanceof Array},me=typeof Array.prototype.indexOf=="function"?function(h,e){return h.indexOf(e)}:function(h,e){for(var n=h.length,t=0;t<n;t++)if(h[t]===e)return t;return-1};function cr(h,e,n,t){for(var a=0;a<n;a++)for(var r=h[a],i=0;i<t;i++){var s=e[i];if(a!==i&&r===s)return!0}}function Z(h,e,n,t,a){var r=h[n],i=e[t];if(r===i)return!0;if((typeof r>"u"?"undefined":I(r))!=="object"||(typeof i>"u"?"undefined":I(i))!=="object")return!1;var s=a.objectHash;if(!s)return a.matchByPosition&&n===t;var o=void 0,l=void 0;return typeof n=="number"?(a.hashCache1=a.hashCache1||[],o=a.hashCache1[n],typeof o>"u"&&(a.hashCache1[n]=o=s(r,n))):o=s(r),typeof o>"u"||(typeof t=="number"?(a.hashCache2=a.hashCache2||[],l=a.hashCache2[t],typeof l>"u"&&(a.hashCache2[t]=l=s(i,t))):l=s(i),typeof l>"u")?!1:o===l}var Ie=function(e){if(!!e.leftIsArray){var n={objectHash:e.options&&e.options.objectHash,matchByPosition:e.options&&e.options.matchByPosition},t=0,a=0,r=void 0,i=void 0,s=void 0,o=e.left,l=e.right,f=o.length,u=l.length,v=void 0;for(f>0&&u>0&&!n.objectHash&&typeof n.matchByPosition!="boolean"&&(n.matchByPosition=!cr(o,l,f,u));t<f&&t<u&&Z(o,l,t,t,n);)r=t,v=new Y(e.left[r],e.right[r]),e.push(v,r),t++;for(;a+t<f&&a+t<u&&Z(o,l,f-1-a,u-1-a,n);)i=f-1-a,s=u-1-a,v=new Y(e.left[i],e.right[s]),e.push(v,s),a++;var p=void 0;if(t+a===f){if(f===u){e.setResult(void 0).exit();return}for(p=p||{_t:"a"},r=t;r<u-a;r++)p[r]=[l[r]];e.setResult(p).exit();return}if(t+a===u){for(p=p||{_t:"a"},r=t;r<f-a;r++)p["_"+r]=[o[r],0,0];e.setResult(p).exit();return}delete n.hashCache1,delete n.hashCache2;var d=o.slice(t,f-a),c=l.slice(t,u-a),g=pr.get(d,c,Z,n),_=[];for(p=p||{_t:"a"},r=t;r<f-a;r++)me(g.indices1,r-t)<0&&(p["_"+r]=[o[r],0,0],_.push(r));var w=!0;e.options&&e.options.arrays&&e.options.arrays.detectMove===!1&&(w=!1);var k=!1;e.options&&e.options.arrays&&e.options.arrays.includeValueOnMove&&(k=!0);var R=_.length;for(r=t;r<u-a;r++){var O=me(g.indices2,r-t);if(O<0){var j=!1;if(w&&R>0){for(var M=0;M<R;M++)if(i=_[M],Z(d,c,i-t,r-t,n)){p["_"+i].splice(1,2,r,W),k||(p["_"+i][0]=""),s=r,v=new Y(e.left[i],e.right[s]),e.push(v,s),_.splice(M,1),j=!0;break}}j||(p[r]=[l[r]])}else i=g.indices1[O]+t,s=g.indices2[O]+t,v=new Y(e.left[i],e.right[s]),e.push(v,s)}e.setResult(p).exit()}};Ie.filterName="arrays";var be={numerically:function(e,n){return e-n},numericallyBy:function(e){return function(n,t){return n[e]-t[e]}}},$e=function(e){if(!!e.nested&&e.delta._t==="a"){var n=void 0,t=void 0,a=e.delta,r=e.left,i=[],s=[],o=[];for(n in a)if(n!=="_t")if(n[0]==="_")if(a[n][2]===0||a[n][2]===W)i.push(parseInt(n.slice(1),10));else throw new Error("only removal or move can be applied at original array indices,"+(" invalid diff type: "+a[n][2]));else a[n].length===1?s.push({index:parseInt(n,10),value:a[n][0]}):o.push({index:parseInt(n,10),delta:a[n]});for(i=i.sort(be.numerically),n=i.length-1;n>=0;n--){t=i[n];var l=a["_"+t],f=r.splice(t,1)[0];l[2]===W&&s.push({index:l[1],value:f})}s=s.sort(be.numericallyBy("index"));var u=s.length;for(n=0;n<u;n++){var v=s[n];r.splice(v.index,0,v.value)}var p=o.length,d=void 0;if(p>0)for(n=0;n<p;n++){var c=o[n];d=new ve(e.left[c.index],c.delta),e.push(d,c.index)}if(!e.children){e.setResult(e.left).exit();return}e.exit()}};$e.filterName="arrays";var Ve=function(e){if(!(!e||!e.children)&&e.delta._t==="a"){for(var n=e.children.length,t=void 0,a=0;a<n;a++)t=e.children[a],e.left[t.childName]=t.result;e.setResult(e.left).exit()}};Ve.filterName="arraysCollectChildren";var Ge=function(e){if(!e.nested){e.delta[2]===W&&(e.newName="_"+e.delta[1],e.setResult([e.delta[0],parseInt(e.childName.substr(1),10),W]).exit());return}if(e.delta._t==="a"){var n=void 0,t=void 0;for(n in e.delta)n!=="_t"&&(t=new pe(e.delta[n]),e.push(t,n));e.exit()}};Ge.filterName="arrays";var dr=function(e,n,t){if(typeof n=="string"&&n[0]==="_")return parseInt(n.substr(1),10);if(ye(t)&&t[2]===0)return"_"+n;var a=+n;for(var r in e){var i=e[r];if(ye(i))if(i[2]===W){var s=parseInt(r.substr(1),10),o=i[1];if(o===+n)return s;s<=a&&o>a?a++:s>=a&&o<a&&a--}else if(i[2]===0){var l=parseInt(r.substr(1),10);l<=a&&a++}else i.length===1&&r<=a&&a--}return a};function He(h){if(!(!h||!h.children)&&h.delta._t==="a"){for(var e=h.children.length,n=void 0,t={_t:"a"},a=0;a<e;a++){n=h.children[a];var r=n.newName;typeof r>"u"&&(r=dr(h.delta,n.childName,n.result)),t[r]!==n.result&&(t[r]=n.result)}h.setResult(t).exit()}}He.filterName="arraysCollectChildren";var Ue=function(e){e.left instanceof Date?(e.right instanceof Date?e.left.getTime()!==e.right.getTime()?e.setResult([e.left,e.right]):e.setResult(void 0):e.setResult([e.left,e.right]),e.exit()):e.right instanceof Date&&e.setResult([e.left,e.right]).exit()};Ue.filterName="dates";var ie=2,gr=60,oe=null,Qe=function(e){if(!oe){var n=void 0;if(typeof diff_match_patch<"u")n=typeof diff_match_patch=="function"?new diff_match_patch:new diff_match_patch.diff_match_patch;else if(se)try{n=se&&new se}catch{n=null}if(!n){if(!e)return null;var t=new Error("text diff_match_patch library not found");throw t.diff_match_patch_not_found=!0,t}oe={diff:function(r,i){return n.patch_toText(n.patch_make(r,i))},patch:function(r,i){for(var s=n.patch_apply(n.patch_fromText(i),r),o=0;o<s[1].length;o++)if(!s[1][o]){var l=new Error("text patch failed");l.textPatchFailed=!0}return s[0]}}}return oe},Ye=function(e){if(e.leftType==="string"){var n=e.options&&e.options.textDiff&&e.options.textDiff.minLength||gr;if(e.left.length<n||e.right.length<n){e.setResult([e.left,e.right]).exit();return}var t=Qe();if(!t){e.setResult([e.left,e.right]).exit();return}var a=t.diff;e.setResult([a(e.left,e.right),0,ie]).exit()}};Ye.filterName="texts";var ze=function(e){if(!e.nested&&e.delta[2]===ie){var n=Qe(!0).patch;e.setResult(n(e.left,e.delta[0])).exit()}};ze.filterName="texts";var yr=function(e){var n=void 0,t=void 0,a=void 0,r=void 0,i=void 0,s=null,o=/^@@ +-(\d+),(\d+) +\+(\d+),(\d+) +@@$/,l=void 0;for(a=e.split(`
`),n=0,t=a.length;n<t;n++){r=a[n];var f=r.slice(0,1);f==="@"?(s=o.exec(r),l=n,a[l]="@@ -"+s[3]+","+s[4]+" +"+s[1]+","+s[2]+" @@"):f==="+"?(a[n]="-"+a[n].slice(1),a[n-1].slice(0,1)==="+"&&(i=a[n],a[n]=a[n-1],a[n-1]=i)):f==="-"&&(a[n]="+"+a[n].slice(1))}return a.join(`
`)},Je=function(e){e.nested||e.delta[2]===ie&&e.setResult([yr(e.delta[0]),0,ie]).exit()};Je.filterName="texts";var mr=function(){function h(e){L(this,h),this.processor=new sr(e),this.processor.pipe(new ee("diff").append(Se,Oe,Ue,Ye,Te,Ie).shouldHaveResult()),this.processor.pipe(new ee("patch").append(Ne,Ve,Ae,ze,Fe,$e).shouldHaveResult()),this.processor.pipe(new ee("reverse").append(Le,He,Pe,Je,Be,Ge).shouldHaveResult())}return $(h,[{key:"options",value:function(){var n;return(n=this.processor).options.apply(n,arguments)}},{key:"diff",value:function(n,t){return this.processor.process(new Y(n,t))}},{key:"patch",value:function(n,t){return this.processor.process(new ve(n,t))}},{key:"reverse",value:function(n){return this.processor.process(new pe(n))}},{key:"unpatch",value:function(n,t){return this.patch(n,this.reverse(t))}},{key:"clone",value:function(n){return te(n)}}]),h}(),fe=typeof Array.isArray=="function"?Array.isArray:function(h){return h instanceof Array},br=typeof Object.keys=="function"?function(h){return Object.keys(h)}:function(h){var e=[];for(var n in h)Object.prototype.hasOwnProperty.call(h,n)&&e.push(n);return e},_r=function(e){return e.substr(0,1)==="_"?e.slice(1):e},_e=function(e){return e==="_t"?-1:e.substr(0,1)==="_"?parseInt(e.slice(1),10):parseInt(e,10)+.1},wr=function(e,n){return _e(e)-_e(n)},ae=function(){function h(){L(this,h)}return $(h,[{key:"format",value:function(n,t){var a={};return this.prepareContext(a),this.recurse(a,n,t),this.finalize(a)}},{key:"prepareContext",value:function(n){n.buffer=[],n.out=function(){var t;(t=this.buffer).push.apply(t,arguments)}}},{key:"typeFormattterNotFound",value:function(n,t){throw new Error("cannot format delta type: "+t)}},{key:"typeFormattterErrorFormatter",value:function(n,t){return t.toString()}},{key:"finalize",value:function(n){var t=n.buffer;if(fe(t))return t.join("")}},{key:"recurse",value:function(n,t,a,r,i,s,o){var l=t&&s,f=l?s.value:a;if(!(typeof t>"u"&&typeof r>"u")){var u=this.getDeltaType(t,s),v=u==="node"?t._t==="a"?"array":"object":"";typeof r<"u"?this.nodeBegin(n,r,i,u,v,o):this.rootBegin(n,u,v);var p=void 0;try{p=this["format_"+u]||this.typeFormattterNotFound(n,u),p.call(this,n,t,f,r,i,s)}catch(d){this.typeFormattterErrorFormatter(n,d,t,f,r,i,s),typeof console<"u"&&console.error&&console.error(d.stack)}typeof r<"u"?this.nodeEnd(n,r,i,u,v,o):this.rootEnd(n,u,v)}}},{key:"formatDeltaChildren",value:function(n,t,a){var r=this;this.forEachDeltaKey(t,a,function(i,s,o,l){r.recurse(n,t[i],a?a[s]:void 0,i,s,o,l)})}},{key:"forEachDeltaKey",value:function(n,t,a){var r=br(n),i=n._t==="a",s={},o=void 0;if(typeof t<"u")for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&typeof n[o]>"u"&&(!i||typeof n["_"+o]>"u")&&r.push(o);for(o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var l=n[o];fe(l)&&l[2]===3&&(s[l[1].toString()]={key:o,value:t&&t[parseInt(o.substr(1))]},this.includeMoveDestinations!==!1&&typeof t>"u"&&typeof n[l[1]]>"u"&&r.push(l[1].toString()))}i?r.sort(wr):r.sort();for(var f=0,u=r.length;f<u;f++){var v=r[f];if(!(i&&v==="_t")){var p=i?typeof v=="number"?v:parseInt(_r(v),10):v,d=f===u-1;a(v,p,s[p],d)}}}},{key:"getDeltaType",value:function(n,t){if(typeof n>"u")return typeof t<"u"?"movedestination":"unchanged";if(fe(n)){if(n.length===1)return"added";if(n.length===2)return"modified";if(n.length===3&&n[2]===0)return"deleted";if(n.length===3&&n[2]===2)return"textdiff";if(n.length===3&&n[2]===3)return"moved"}else if((typeof n>"u"?"undefined":I(n))==="object")return"node";return"unknown"}},{key:"parseTextDiff",value:function(n){for(var t=[],a=n.split(`
@@ `),r=0,i=a.length;r<i;r++){var s=a[r],o={pieces:[]},l=/^(?:@@ )?[-+]?(\d+),(\d+)/.exec(s).slice(1);o.location={line:l[0],chr:l[1]};for(var f=s.split(`
`).slice(1),u=0,v=f.length;u<v;u++){var p=f[u];if(!!p.length){var d={type:"context"};p.substr(0,1)==="+"?d.type="added":p.substr(0,1)==="-"&&(d.type="deleted"),d.text=p.slice(1),o.pieces.push(d)}}t.push(o)}return t}}]),h}();(function(h){z(e,h);function e(){return L(this,e),J(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return $(e,[{key:"typeFormattterErrorFormatter",value:function(t,a){t.out('<pre class="jsondiffpatch-error">'+a+"</pre>")}},{key:"formatValue",value:function(t,a){t.out("<pre>"+we(JSON.stringify(a,null,2))+"</pre>")}},{key:"formatTextDiffString",value:function(t,a){var r=this.parseTextDiff(a);t.out('<ul class="jsondiffpatch-textdiff">');for(var i=0,s=r.length;i<s;i++){var o=r[i];t.out('<li><div class="jsondiffpatch-textdiff-location">'+('<span class="jsondiffpatch-textdiff-line-number">'+o.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+o.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">'));for(var l=o.pieces,f=0,u=l.length;f<u;f++){var v=l[f];t.out('<span class="jsondiffpatch-textdiff-'+v.type+'">'+we(decodeURI(v.text))+"</span>")}t.out("</div></li>")}t.out("</ul>")}},{key:"rootBegin",value:function(t,a,r){var i="jsondiffpatch-"+a+(r?" jsondiffpatch-child-node-type-"+r:"");t.out('<div class="jsondiffpatch-delta '+i+'">')}},{key:"rootEnd",value:function(t){t.out("</div>"+(t.hasArrows?'<script type="text/javascript">setTimeout('+(kr.toString()+",10);</script>"):""))}},{key:"nodeBegin",value:function(t,a,r,i,s){var o="jsondiffpatch-"+i+(s?" jsondiffpatch-child-node-type-"+s:"");t.out('<li class="'+o+'" data-key="'+r+'">'+('<div class="jsondiffpatch-property-name">'+r+"</div>"))}},{key:"nodeEnd",value:function(t){t.out("</li>")}},{key:"format_unchanged",value:function(t,a,r){typeof r>"u"||(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,r),t.out("</div>"))}},{key:"format_movedestination",value:function(t,a,r){typeof r>"u"||(t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,r),t.out("</div>"))}},{key:"format_node",value:function(t,a,r){var i=a._t==="a"?"array":"object";t.out('<ul class="jsondiffpatch-node jsondiffpatch-node-type-'+i+'">'),this.formatDeltaChildren(t,a,r),t.out("</ul>")}},{key:"format_added",value:function(t,a){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,a[0]),t.out("</div>")}},{key:"format_modified",value:function(t,a){t.out('<div class="jsondiffpatch-value jsondiffpatch-left-value">'),this.formatValue(t,a[0]),t.out('</div><div class="jsondiffpatch-value jsondiffpatch-right-value">'),this.formatValue(t,a[1]),t.out("</div>")}},{key:"format_deleted",value:function(t,a){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,a[0]),t.out("</div>")}},{key:"format_moved",value:function(t,a){t.out('<div class="jsondiffpatch-value">'),this.formatValue(t,a[0]),t.out('</div><div class="jsondiffpatch-moved-destination">'+a[1]+"</div>"),t.out(`<div class="jsondiffpatch-arrow" style="position: relative; left: -34px;">
          <svg width="30" height="60" style="position: absolute; display: none;">
          <defs>
              <marker id="markerArrow" markerWidth="8" markerHeight="8"
                 refx="2" refy="4"
                     orient="auto" markerUnits="userSpaceOnUse">
                  <path d="M1,1 L1,7 L7,4 L1,1" style="fill: #339;" />
              </marker>
          </defs>
          <path d="M30,0 Q-10,25 26,50"
            style="stroke: #88f; stroke-width: 2px; fill: none; stroke-opacity: 0.5; marker-end: url(#markerArrow);"
          ></path>
          </svg>
      </div>`),t.hasArrows=!0}},{key:"format_textdiff",value:function(t,a){t.out('<div class="jsondiffpatch-value">'),this.formatTextDiffString(t,a[0]),t.out("</div>")}}]),e})(ae);function we(h){for(var e=h,n=[[/&/g,"&amp;"],[/</g,"&lt;"],[/>/g,"&gt;"],[/'/g,"&apos;"],[/"/g,"&quot;"]],t=0;t<n.length;t++)e=e.replace(n[t][0],n[t][1]);return e}var kr=function(e){var n=e||document,t=function(s){var o=s.textContent,l=s.innerText;return o||l},a=function(s,o,l){for(var f=s.querySelectorAll(o),u=0,v=f.length;u<v;u++)l(f[u])},r=function(s,o){for(var l=s.children,f=0,u=l.length;f<u;f++)o(l[f],f)};a(n,".jsondiffpatch-arrow",function(i){var s=i.parentNode,o=i.children,l=i.style,f=s,u=o[0],v=u.children[1];u.style.display="none";var p=t(f.querySelector(".jsondiffpatch-moved-destination")),d=f.parentNode,c=void 0;if(r(d,function(w){w.getAttribute("data-key")===p&&(c=w)}),!!c)try{var g=c.offsetTop-f.offsetTop;u.setAttribute("height",Math.abs(g)+6),l.top=-8+(g>0?0:g)+"px";var _=g>0?"M30,0 Q-10,"+Math.round(g/2)+" 26,"+(g-4):"M30,"+-g+" Q-10,"+Math.round(-g/2)+" 26,4";v.setAttribute("d",_),u.style.display=""}catch{}})},X=function(h){z(e,h);function e(){L(this,e);var n=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.includeMoveDestinations=!1,n}return $(e,[{key:"prepareContext",value:function(t){he(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"prepareContext",this).call(this,t),t.indent=function(a){this.indentLevel=(this.indentLevel||0)+(typeof a>"u"?1:a),this.indentPad=new Array(this.indentLevel+1).join("&nbsp;&nbsp;")},t.row=function(a,r){t.out('<tr><td style="white-space: nowrap;"><pre class="jsondiffpatch-annotated-indent" style="display: inline-block">'),t.out(t.indentPad),t.out('</pre><pre style="display: inline-block">'),t.out(a),t.out('</pre></td><td class="jsondiffpatch-delta-note"><div>'),t.out(r),t.out("</div></td></tr>")}}},{key:"typeFormattterErrorFormatter",value:function(t,a){t.row("",'<pre class="jsondiffpatch-error">'+a+"</pre>")}},{key:"formatTextDiffString",value:function(t,a){var r=this.parseTextDiff(a);t.out('<ul class="jsondiffpatch-textdiff">');for(var i=0,s=r.length;i<s;i++){var o=r[i];t.out('<li><div class="jsondiffpatch-textdiff-location">'+('<span class="jsondiffpatch-textdiff-line-number">'+o.location.line+'</span><span class="jsondiffpatch-textdiff-char">'+o.location.chr+'</span></div><div class="jsondiffpatch-textdiff-line">'));for(var l=o.pieces,f=0,u=l.length;f<u;f++){var v=l[f];t.out('<span class="jsondiffpatch-textdiff-'+v.type+'">'+v.text+"</span>")}t.out("</div></li>")}t.out("</ul>")}},{key:"rootBegin",value:function(t,a,r){t.out('<table class="jsondiffpatch-annotated-delta">'),a==="node"&&(t.row("{"),t.indent()),r==="array"&&t.row('"_t": "a",',"Array delta (member names indicate array indices)")}},{key:"rootEnd",value:function(t,a){a==="node"&&(t.indent(-1),t.row("}")),t.out("</table>")}},{key:"nodeBegin",value:function(t,a,r,i,s){t.row("&quot;"+a+"&quot;: {"),i==="node"&&t.indent(),s==="array"&&t.row('"_t": "a",',"Array delta (member names indicate array indices)")}},{key:"nodeEnd",value:function(t,a,r,i,s,o){i==="node"&&t.indent(-1),t.row("}"+(o?"":","))}},{key:"format_unchanged",value:function(){}},{key:"format_movedestination",value:function(){}},{key:"format_node",value:function(t,a,r){this.formatDeltaChildren(t,a,r)}}]),e}(ae),K=function(e){return'<pre style="display:inline-block">&quot;'+e+"&quot;</pre>"},Er={added:function(e,n,t,a){var r=" <pre>([newValue])</pre>";return typeof a>"u"?"new value"+r:typeof a=="number"?"insert at index "+a+r:"add property "+K(a)+r},modified:function(e,n,t,a){var r=" <pre>([previousValue, newValue])</pre>";return typeof a>"u"?"modify value"+r:typeof a=="number"?"modify at index "+a+r:"modify property "+K(a)+r},deleted:function(e,n,t,a){var r=" <pre>([previousValue, 0, 0])</pre>";return typeof a>"u"?"delete value"+r:typeof a=="number"?"remove index "+a+r:"delete property "+K(a)+r},moved:function(e,n,t,a){return'move from <span title="(position to remove at original state)">'+("index "+a+'</span> to <span title="(position to insert at final')+(' state)">index '+e[1]+"</span>")},textdiff:function(e,n,t,a){var r=typeof a>"u"?"":typeof a=="number"?" at index "+a:" at property "+K(a);return"text diff"+r+', format is <a href="https://code.google.com/p/google-diff-match-patch/wiki/Unidiff">a variation of Unidiff</a>'}},q=function(e,n){var t=this.getDeltaType(n),a=Er[t],r=a&&a.apply(a,Array.prototype.slice.call(arguments,1)),i=JSON.stringify(n,null,2);t==="textdiff"&&(i=i.split("\\n").join(`\\n"+
   "`)),e.indent(),e.row(i,r),e.indent(-1)};X.prototype.format_added=q;X.prototype.format_modified=q;X.prototype.format_deleted=q;X.prototype.format_moved=q;X.prototype.format_textdiff=q;var x={add:"add",remove:"remove",replace:"replace",move:"move"};(function(h){z(e,h);function e(){L(this,e);var n=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.includeMoveDestinations=!0,n}return $(e,[{key:"prepareContext",value:function(t){he(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"prepareContext",this).call(this,t),t.result=[],t.path=[],t.pushCurrentOp=function(a){var r=a.op,i=a.value,s={op:r,path:this.currentPath()};typeof i<"u"&&(s.value=i),this.result.push(s)},t.pushMoveOp=function(a){var r=this.currentPath();this.result.push({op:x.move,from:r,path:this.toPath(a)})},t.currentPath=function(){return"/"+this.path.join("/")},t.toPath=function(a){var r=this.path.slice();return r[r.length-1]=a,"/"+r.join("/")}}},{key:"typeFormattterErrorFormatter",value:function(t,a){t.out("[ERROR] "+a)}},{key:"rootBegin",value:function(){}},{key:"rootEnd",value:function(){}},{key:"nodeBegin",value:function(t,a,r){var i=t.path;i.push(r)}},{key:"nodeEnd",value:function(t){var a=t.path;a.pop()}},{key:"format_unchanged",value:function(){}},{key:"format_movedestination",value:function(){}},{key:"format_node",value:function(t,a,r){this.formatDeltaChildren(t,a,r)}},{key:"format_added",value:function(t,a){t.pushCurrentOp({op:x.add,value:a[0]})}},{key:"format_modified",value:function(t,a){t.pushCurrentOp({op:x.replace,value:a[1]})}},{key:"format_deleted",value:function(t){t.pushCurrentOp({op:x.remove})}},{key:"format_moved",value:function(t,a){var r=a[1];t.pushMoveOp(r)}},{key:"format_textdiff",value:function(){throw new Error("Not implemented")}},{key:"format",value:function(t,a){var r={};return this.prepareContext(r),this.recurse(r,t,a),r.result}}]),e})(ae);function U(h){return ge&&ge[h]||function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return n}}var Q={added:U("green"),deleted:U("red"),movedestination:U("gray"),moved:U("yellow"),unchanged:U("gray"),error:U("white.bgRed"),textDiffLine:U("gray")};(function(h){z(e,h);function e(){L(this,e);var n=J(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.includeMoveDestinations=!1,n}return $(e,[{key:"prepareContext",value:function(t){he(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"prepareContext",this).call(this,t),t.indent=function(a){this.indentLevel=(this.indentLevel||0)+(typeof a>"u"?1:a),this.indentPad=new Array(this.indentLevel+1).join("  "),this.outLine()},t.outLine=function(){this.buffer.push(`
`+(this.indentPad||""))},t.out=function(){for(var a=arguments.length,r=Array(a),i=0;i<a;i++)r[i]=arguments[i];for(var s=0,o=r.length;s<o;s++){var l=r[s].split(`
`),f=l.join(`
`+(this.indentPad||""));this.color&&this.color[0]&&(f=this.color[0](f)),this.buffer.push(f)}},t.pushColor=function(a){this.color=this.color||[],this.color.unshift(a)},t.popColor=function(){this.color=this.color||[],this.color.shift()}}},{key:"typeFormattterErrorFormatter",value:function(t,a){t.pushColor(Q.error),t.out("[ERROR]"+a),t.popColor()}},{key:"formatValue",value:function(t,a){t.out(JSON.stringify(a,null,2))}},{key:"formatTextDiffString",value:function(t,a){var r=this.parseTextDiff(a);t.indent();for(var i=0,s=r.length;i<s;i++){var o=r[i];t.pushColor(Q.textDiffLine),t.out(o.location.line+","+o.location.chr+" "),t.popColor();for(var l=o.pieces,f=0,u=l.length;f<u;f++){var v=l[f];t.pushColor(Q[v.type]),t.out(v.text),t.popColor()}i<s-1&&t.outLine()}t.indent(-1)}},{key:"rootBegin",value:function(t,a,r){t.pushColor(Q[a]),a==="node"&&(t.out(r==="array"?"[":"{"),t.indent())}},{key:"rootEnd",value:function(t,a,r){a==="node"&&(t.indent(-1),t.out(r==="array"?"]":"}")),t.popColor()}},{key:"nodeBegin",value:function(t,a,r,i,s){t.pushColor(Q[i]),t.out(r+": "),i==="node"&&(t.out(s==="array"?"[":"{"),t.indent())}},{key:"nodeEnd",value:function(t,a,r,i,s,o){i==="node"&&(t.indent(-1),t.out(s==="array"?"]":"}"+(o?"":","))),o||t.outLine(),t.popColor()}},{key:"format_unchanged",value:function(t,a,r){typeof r>"u"||this.formatValue(t,r)}},{key:"format_movedestination",value:function(t,a,r){typeof r>"u"||this.formatValue(t,r)}},{key:"format_node",value:function(t,a,r){this.formatDeltaChildren(t,a,r)}},{key:"format_added",value:function(t,a){this.formatValue(t,a[0])}},{key:"format_modified",value:function(t,a){t.pushColor(Q.deleted),this.formatValue(t,a[0]),t.popColor(),t.out(" => "),t.pushColor(Q.added),this.formatValue(t,a[1]),t.popColor()}},{key:"format_deleted",value:function(t,a){this.formatValue(t,a[0])}},{key:"format_moved",value:function(t,a){t.out("==> "+a[1])}},{key:"format_textdiff",value:function(t,a){this.formatTextDiffString(t,a[0])}}]),e})(ae);function le(h){return le=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},le(h)}function ue(){ue=function(){return h};var h={},e=Object.prototype,n=e.hasOwnProperty,t=Object.defineProperty||function(m,y,b){m[y]=b.value},a=typeof Symbol=="function"?Symbol:{},r=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",s=a.toStringTag||"@@toStringTag";function o(m,y,b){return Object.defineProperty(m,y,{value:b,enumerable:!0,configurable:!0,writable:!0}),m[y]}try{o({},"")}catch{o=function(b,E,C){return b[E]=C}}function l(m,y,b,E){var C=y&&y.prototype instanceof v?y:v,D=Object.create(C.prototype),T=new P(E||[]);return t(D,"_invoke",{value:O(m,b,T)}),D}function f(m,y,b){try{return{type:"normal",arg:m.call(y,b)}}catch(E){return{type:"throw",arg:E}}}h.wrap=l;var u={};function v(){}function p(){}function d(){}var c={};o(c,r,function(){return this});var g=Object.getPrototypeOf,_=g&&g(g(F([])));_&&_!==e&&n.call(_,r)&&(c=_);var w=d.prototype=v.prototype=Object.create(c);function k(m){["next","throw","return"].forEach(function(y){o(m,y,function(b){return this._invoke(y,b)})})}function R(m,y){function b(C,D,T,N){var B=f(m[C],m,D);if(B.type!=="throw"){var G=B.arg,V=G.value;return V&&le(V)=="object"&&n.call(V,"__await")?y.resolve(V.__await).then(function(H){b("next",H,T,N)},function(H){b("throw",H,T,N)}):y.resolve(V).then(function(H){G.value=H,T(G)},function(H){return b("throw",H,T,N)})}N(B.arg)}var E;t(this,"_invoke",{value:function(D,T){function N(){return new y(function(B,G){b(D,T,B,G)})}return E=E?E.then(N,N):N()}})}function O(m,y,b){var E="suspendedStart";return function(C,D){if(E==="executing")throw new Error("Generator is already running");if(E==="completed"){if(C==="throw")throw D;return S()}for(b.method=C,b.arg=D;;){var T=b.delegate;if(T){var N=j(T,b);if(N){if(N===u)continue;return N}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(E==="suspendedStart")throw E="completed",b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);E="executing";var B=f(m,y,b);if(B.type==="normal"){if(E=b.done?"completed":"suspendedYield",B.arg===u)continue;return{value:B.arg,done:b.done}}B.type==="throw"&&(E="completed",b.method="throw",b.arg=B.arg)}}}function j(m,y){var b=m.iterator[y.method];if(b===void 0){if(y.delegate=null,y.method==="throw"){if(m.iterator.return&&(y.method="return",y.arg=void 0,j(m,y),y.method==="throw"))return u;y.method="throw",y.arg=new TypeError("The iterator does not provide a 'throw' method")}return u}var E=f(b,m.iterator,y.arg);if(E.type==="throw")return y.method="throw",y.arg=E.arg,y.delegate=null,u;var C=E.arg;return C?C.done?(y[m.resultName]=C.value,y.next=m.nextLoc,y.method!=="return"&&(y.method="next",y.arg=void 0),y.delegate=null,u):C:(y.method="throw",y.arg=new TypeError("iterator result is not an object"),y.delegate=null,u)}function M(m){var y={tryLoc:m[0]};1 in m&&(y.catchLoc=m[1]),2 in m&&(y.finallyLoc=m[2],y.afterLoc=m[3]),this.tryEntries.push(y)}function A(m){var y=m.completion||{};y.type="normal",delete y.arg,m.completion=y}function P(m){this.tryEntries=[{tryLoc:"root"}],m.forEach(M,this),this.reset(!0)}function F(m){if(m){var y=m[r];if(y)return y.call(m);if(typeof m.next=="function")return m;if(!isNaN(m.length)){var b=-1,E=function C(){for(;++b<m.length;)if(n.call(m,b))return C.value=m[b],C.done=!1,C;return C.value=void 0,C.done=!0,C};return E.next=E}}return{next:S}}function S(){return{value:void 0,done:!0}}return p.prototype=d,t(w,"constructor",{value:d,configurable:!0}),t(d,"constructor",{value:p,configurable:!0}),p.displayName=o(d,s,"GeneratorFunction"),h.isGeneratorFunction=function(m){var y=typeof m=="function"&&m.constructor;return!!y&&(y===p||(y.displayName||y.name)==="GeneratorFunction")},h.mark=function(m){return Object.setPrototypeOf?Object.setPrototypeOf(m,d):(m.__proto__=d,o(m,s,"GeneratorFunction")),m.prototype=Object.create(w),m},h.awrap=function(m){return{__await:m}},k(R.prototype),o(R.prototype,i,function(){return this}),h.AsyncIterator=R,h.async=function(m,y,b,E,C){C===void 0&&(C=Promise);var D=new R(l(m,y,b,E),C);return h.isGeneratorFunction(y)?D:D.next().then(function(T){return T.done?T.value:D.next()})},k(w),o(w,s,"Generator"),o(w,r,function(){return this}),o(w,"toString",function(){return"[object Generator]"}),h.keys=function(m){var y=Object(m),b=[];for(var E in y)b.push(E);return b.reverse(),function C(){for(;b.length;){var D=b.pop();if(D in y)return C.value=D,C.done=!1,C}return C.done=!0,C}},h.values=F,P.prototype={constructor:P,reset:function(y){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(A),!y)for(var b in this)b.charAt(0)==="t"&&n.call(this,b)&&!isNaN(+b.slice(1))&&(this[b]=void 0)},stop:function(){this.done=!0;var y=this.tryEntries[0].completion;if(y.type==="throw")throw y.arg;return this.rval},dispatchException:function(y){if(this.done)throw y;var b=this;function E(G,V){return T.type="throw",T.arg=y,b.next=G,V&&(b.method="next",b.arg=void 0),!!V}for(var C=this.tryEntries.length-1;C>=0;--C){var D=this.tryEntries[C],T=D.completion;if(D.tryLoc==="root")return E("end");if(D.tryLoc<=this.prev){var N=n.call(D,"catchLoc"),B=n.call(D,"finallyLoc");if(N&&B){if(this.prev<D.catchLoc)return E(D.catchLoc,!0);if(this.prev<D.finallyLoc)return E(D.finallyLoc)}else if(N){if(this.prev<D.catchLoc)return E(D.catchLoc,!0)}else{if(!B)throw new Error("try statement without catch or finally");if(this.prev<D.finallyLoc)return E(D.finallyLoc)}}}},abrupt:function(y,b){for(var E=this.tryEntries.length-1;E>=0;--E){var C=this.tryEntries[E];if(C.tryLoc<=this.prev&&n.call(C,"finallyLoc")&&this.prev<C.finallyLoc){var D=C;break}}D&&(y==="break"||y==="continue")&&D.tryLoc<=b&&b<=D.finallyLoc&&(D=null);var T=D?D.completion:{};return T.type=y,T.arg=b,D?(this.method="next",this.next=D.finallyLoc,u):this.complete(T)},complete:function(y,b){if(y.type==="throw")throw y.arg;return y.type==="break"||y.type==="continue"?this.next=y.arg:y.type==="return"?(this.rval=this.arg=y.arg,this.method="return",this.next="end"):y.type==="normal"&&b&&(this.next=b),u},finish:function(y){for(var b=this.tryEntries.length-1;b>=0;--b){var E=this.tryEntries[b];if(E.finallyLoc===y)return this.complete(E.completion,E.afterLoc),A(E),u}},catch:function(y){for(var b=this.tryEntries.length-1;b>=0;--b){var E=this.tryEntries[b];if(E.tryLoc===y){var C=E.completion;if(C.type==="throw"){var D=C.arg;A(E)}return D}}throw new Error("illegal catch attempt")},delegateYield:function(y,b,E){return this.delegate={iterator:F(y),resultName:b,nextLoc:E},this.method==="next"&&(this.arg=void 0),u}},h}function ke(h,e,n,t,a,r,i){try{var s=h[r](i),o=s.value}catch(l){n(l);return}s.done?e(o):Promise.resolve(o).then(t,a)}function Cr(h){return function(){var e=this,n=arguments;return new Promise(function(t,a){var r=h.apply(e,n);function i(o){ke(r,t,a,i,s,"next",o)}function s(o){ke(r,t,a,i,s,"throw",o)}i(void 0)})}}function Dr(h,e){if(!(h instanceof e))throw new TypeError("Cannot call a class as a function")}function Ee(h,e){for(var n=0;n<e.length;n++){var t=e[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(h,t.key,t)}}function Rr(h,e,n){return e&&Ee(h.prototype,e),n&&Ee(h,n),Object.defineProperty(h,"prototype",{writable:!1}),h}function Ce(h,e,n){return e in h?Object.defineProperty(h,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):h[e]=n,h}var Br=function(){function h(){Dr(this,h),Ce(this,"diffPatcher",new mr({arrays:{detectMove:!1,includeValueOnMove:!1},textDiff:{minLength:1}})),Ce(this,"scheduler",new Xe)}return Rr(h,[{key:"diff",value:function(){var e=Cr(ue().mark(function t(a){return ue().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,this.scheduler.request();case 2:return i.abrupt("return",{id:a.id,delta:this.diffPatcher.diff(a.a,a.b)});case 3:case"end":return i.stop()}},t,this)}));function n(t){return e.apply(this,arguments)}return n}()}]),h}();export{Br as JsonDiffMain};
